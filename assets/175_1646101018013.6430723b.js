import{T,v as B}from"./12_1646101018013.b1afcf9d.js";import{p as E}from"./217_1646101018014.daee3b8d.js";import{b as D}from"./214_1646101018014.06bd1f42.js";import{u as _}from"./215_1646101018014.7d28851d.js";import{u as L}from"./271_1646101018014.1675c083.js";import{u as R}from"./238_1646101018014.bb845479.js";import{P as K}from"./268_1646101018014.f837e382.js";import{I as F}from"./51_1646101018013.d1160250.js";import{O as G}from"./63_1646101018013.02dd1288.js";import{d as H,a as N,w as $,n as M,g as U,v as V,x as Y,p as Z,c as s,T as j,F as q,u as J,m as Q}from"./99_1646101018013.e8dd0c74.js";import{c as W}from"./212_1646101018014.26076ede.js";import{H as X}from"./210_1646101018014.6f39f4d7.js";import{e as ee}from"./205_1646101018014.c75ed9c4.js";import{a as m}from"./206_1646101018014.66cb7070.js";import{c as oe}from"./208_1646101018014.acb7bfa2.js";import{a as h}from"./225_1646101018014.42d478d6.js";import{i as ne}from"./211_1646101018014.487437fa.js";const te=ee({},E,{round:Boolean,position:m("center"),closeIcon:m("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:m("top-right"),safeAreaInsetBottom:Boolean}),[ae,I]=oe("popup");let P=2e3;var xe=H({name:ae,inheritAttrs:!1,props:te,emits:["open","close","opened","closed","keydown","update:show","click-overlay","click-close-icon"],setup(e,{emit:n,attrs:v,slots:d}){let a,r;const f=h(),l=h(),k=R(()=>e.show||!e.lazyRender),x=N(()=>{const o={zIndex:f.value};if(ne(e.duration)){const t=e.position==="center"?"animationDuration":"transitionDuration";o[t]=`${e.duration}s`}return o}),y=()=>{a||(e.zIndex!==void 0&&(P=+e.zIndex),a=!0,f.value=++P,n("open"))},i=()=>{a&&W(e.beforeClose,{done(){a=!1,n("close"),n("update:show",!1)}})},C=o=>{n("click-overlay",o),e.closeOnClickOverlay&&i()},p=()=>{if(e.overlay)return s(G,{show:e.show,class:e.overlayClass,zIndex:f.value,duration:e.duration,customStyle:e.overlayStyle,onClick:C},{default:d["overlay-content"]})},O=o=>{n("click-close-icon",o),i()},b=()=>{if(e.closeable)return s(F,{role:"button",tabindex:0,name:e.closeIcon,class:[I("close-icon",e.closeIconPosition),X],classPrefix:e.iconPrefix,onClick:O},null)},S=()=>n("opened"),A=()=>n("closed"),g=o=>n("keydown",o),z=k(()=>{var o;const{round:t,position:c,safeAreaInsetBottom:u}=e;return J(s("div",Q({ref:l,style:x.value,class:[I({round:t,[c]:c}),{"van-safe-area-bottom":u}],onKeydown:g},v),[(o=d.default)==null?void 0:o.call(d),b()]),[[B,e.show]])}),w=()=>{const{position:o,transition:t,transitionAppear:c}=e,u=o==="center"?"van-fade":`van-popup-slide-${o}`;return s(T,{name:t||u,appear:c,onAfterEnter:S,onAfterLeave:A},{default:z})};return $(()=>e.show,o=>{o&&!a&&(y(),v.tabindex===0&&M(()=>{var t;(t=l.value)==null||t.focus()})),!o&&a&&(a=!1,n("close"))}),_({popupRef:l}),L(l,()=>e.show&&e.lockScroll),D("popstate",()=>{e.closeOnPopstate&&(i(),r=!1)}),U(()=>{e.show&&y()}),V(()=>{r&&(n("update:show",!0),r=!1)}),Y(()=>{e.show&&(i(),r=!0)}),Z(K,()=>e.show),()=>e.teleport?s(j,{to:e.teleport},{default:()=>[p(),w()]}):s(q,null,[p(),w()])}});export{xe as s};
