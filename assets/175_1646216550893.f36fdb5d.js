import{T as g,v as B}from"./12_1646216550893.29d50c88.js";import{p as E}from"./221_1646216550893.10d33c32.js";import{b as D}from"./215_1646216550893.2d52b40a.js";import{u as _}from"./216_1646216550893.f22b3595.js";import{u as L}from"./272_1646216550893.98b20c71.js";import{u as R}from"./239_1646216550893.b0515933.js";import{P as K}from"./266_1646216550893.5e634424.js";import{I as F}from"./51_1646216550893.73fb23c9.js";import{O as G}from"./63_1646216550893.21e3ebbf.js";import{d as H,a as N,w as $,n as M,e as U,v as V,x as Y,p as Z,c as s,T as j,F as q,u as J,m as Q}from"./99_1646216550893.8a39810b.js";import{c as W}from"./213_1646216550893.fe28df94.js";import{H as X}from"./211_1646216550893.05ad8907.js";import{e as ee}from"./206_1646216550893.699c29eb.js";import{a as m}from"./207_1646216550893.0f52dc9d.js";import{c as oe}from"./209_1646216550893.0ab1a9b2.js";import{a as h}from"./222_1646216550893.c56899af.js";import{i as ne}from"./212_1646216550893.8e2e10ec.js";const te=ee({},E,{round:Boolean,position:m("center"),closeIcon:m("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:m("top-right"),safeAreaInsetBottom:Boolean}),[ae,I]=oe("popup");let P=2e3;var xe=H({name:ae,inheritAttrs:!1,props:te,emits:["open","close","opened","closed","keydown","update:show","click-overlay","click-close-icon"],setup(e,{emit:n,attrs:v,slots:d}){let a,r;const f=h(),l=h(),k=R(()=>e.show||!e.lazyRender),x=N(()=>{const o={zIndex:f.value};if(ne(e.duration)){const t=e.position==="center"?"animationDuration":"transitionDuration";o[t]=`${e.duration}s`}return o}),y=()=>{a||(e.zIndex!==void 0&&(P=+e.zIndex),a=!0,f.value=++P,n("open"))},i=()=>{a&&W(e.beforeClose,{done(){a=!1,n("close"),n("update:show",!1)}})},C=o=>{n("click-overlay",o),e.closeOnClickOverlay&&i()},p=()=>{if(e.overlay)return s(G,{show:e.show,class:e.overlayClass,zIndex:f.value,duration:e.duration,customStyle:e.overlayStyle,onClick:C},{default:d["overlay-content"]})},O=o=>{n("click-close-icon",o),i()},b=()=>{if(e.closeable)return s(F,{role:"button",tabindex:0,name:e.closeIcon,class:[I("close-icon",e.closeIconPosition),X],classPrefix:e.iconPrefix,onClick:O},null)},S=()=>n("opened"),A=()=>n("closed"),z=o=>n("keydown",o),T=k(()=>{var o;const{round:t,position:c,safeAreaInsetBottom:u}=e;return J(s("div",Q({ref:l,style:x.value,class:[I({round:t,[c]:c}),{"van-safe-area-bottom":u}],onKeydown:z},v),[(o=d.default)==null?void 0:o.call(d),b()]),[[B,e.show]])}),w=()=>{const{position:o,transition:t,transitionAppear:c}=e,u=o==="center"?"van-fade":`van-popup-slide-${o}`;return s(g,{name:t||u,appear:c,onAfterEnter:S,onAfterLeave:A},{default:T})};return $(()=>e.show,o=>{o&&!a&&(y(),v.tabindex===0&&M(()=>{var t;(t=l.value)==null||t.focus()})),!o&&a&&(a=!1,n("close"))}),_({popupRef:l}),L(l,()=>e.show&&e.lockScroll),D("popstate",()=>{e.closeOnPopstate&&(i(),r=!1)}),U(()=>{e.show&&y()}),V(()=>{r&&(n("update:show",!0),r=!1)}),Y(()=>{e.show&&(i(),r=!0)}),Z(K,()=>e.show),()=>e.teleport?s(j,{to:e.teleport},{default:()=>[p(),w()]}):s(q,null,[p(),w()])}});export{xe as s};
